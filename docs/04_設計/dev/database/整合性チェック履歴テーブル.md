# テーブル定義書

---

## 1. テーブル論理名

整合性チェック履歴

---

## 2. テーブル物理名

CM_T_CONSIST_CHK_HIST

---

## 3. 概要

整合性違反やチェック結果の履歴管理（いつ・誰が・どのデータで・どのルールに違反したか）を行う。

---

## 4. テーブル定義

| No | 論理名         | 物理名         | データ型 | 桁数 | PK | NN | 初期値           | 備考         |
|----|----------------|----------------|----------|------|----|----|------------------|--------------|
| 1  | 履歴ID         | HIST_ID        | varchar  | 50   | ○  | ○  |        |              |
| 2  | チェック日時   | CHECKED_AT     | datetime |      |    | ○  | CURRENT_TIMESTAMP|      |
| 3  | チェック者ID   | CHECKED_BY     | varchar  | 50   |    | ○  |        |              |
| 4  | マスタID       | MST_ID         | varchar  | 50   |    |    |        |              |
| 5  | データID       | DATA_ID        | varchar  | 50   |    |    |        |              |
| 6  | ルールID       | RULE_ID        | varchar  | 50   |    |    |        |              |
| 7  | チェック種別   | CHECK_TYPE     | varchar  | 30   |    |    |        | 整合性/バリデ/リレーション等|
| 8  | チェック詳細   | CHECK_DETAIL   | varchar  | 200  |    |    |        | チェック内容詳細|
| 9  | 結果           | RESULT         | varchar  | 10   |    | ○  |        | OK/NG        |
| 10 | エラー内容     | ERROR_MSG      | varchar  | 200  |    |    |        |              |
| 11 | 拡張設定       | EXT_JSON       | json     |      |    |    |        | 拡張用設定(JSON)|

---

## 5. インデックス定義

| インデックス名 | カラム名 | ユニーク | 備考 |
|----------------|----------|----------|------|
| PK_CM_T_CONSIST_CHK_HIST| HIST_ID | ○        | 主キー|

---

## 6. 制約事項

---

## 7. 備考

- チェック種別や詳細、拡張設定で履歴の分析やトレーサビリティが強化可能。

---

## 8. 関連テーブル

| テーブル | 関係性 |
|----------|--------|
| CM_M_MST_DEF | 多対1 |
| CM_M_RULE_DEF | 多対1 |